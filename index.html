<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction Data</title>

    <!-- jQuery Library -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>

    <!-- flowbite js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@9.0.3"></script>

</head>
<body>
    <table id="search-table">
        <thead>
            <tr>
                <th>
                    <span class="flex items-center">
                        Transaction ID
                    </span>
                </th>
                <th>
                    <span class="flex items-center">
                        Total Amount
                    </span>
                </th>
                <th>
                    <span class="flex items-center">
                        Payment Proof
                    </span>
                </th>
                <th>
                    <span class="flex items-center">
                        Transaction Date
                    </span>
                </th>
                <th>
                    <span class="flex items-center">
                        Status
                    </span>
                </th>
                <th>
                    <span class="flex items-center">
                        User Details
                    </span>
                </th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <!-- Main container -->
    <div class="flex mx-auto">
        <table id="transactionsTable" style="width:100%">
            <thead>
                <tr>
                    <th>Transaction ID</th>
                    <th>Total Amount</th>
                    <th>Payment Method</th>
                    <th>Payment Proof</th>
                    <th>Transaction Date</th>
                    <th>Status</th>
                    <th>User Details</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data will be dynamically populated here -->
            </tbody>
        </table>
    </div>

    <!-- Initialize DataTables -->
    <script>
        $(document).ready(function() {
            if (document.getElementById("search-table") && typeof simpleDatatables.DataTable !== 'undefined') {
                const dataTable = new simpleDatatables.DataTable("#search-table", {
                    searchable: true,
                    sortable: false,
                    ajax: {
                        url: "get_transactions.php", // Replace with the correct PHP script URL
                        dataSrc: "" // Response is directly the JSON array, no need for 'data' field
                    },
                    columns: [
                        { "data": "transaction_id" },
                        { "data": "total_amount" },
                        { "data": "payment_method" },
                        { "data": "payment_proof" },
                        { "data": "transaction_date" },
                        { "data": "status" },
                        {
                            "data": null,
                            "render": function(data, type, row) {
                                return `
                                    <div>
                                        <p class="font-semibold">${row.name_1}</p>
                                        <p>${row.phone_1} | ${row.email_1}</p>
                                        <p class="italic">${row.mantan_1}</p>
                                    </div>
                                `;
                            }
                        }
                    ]
                });
            }
        });
    </script>

</body>
</html>