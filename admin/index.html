<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction Data</title>

    <!-- Flowbite CSS (Tailwind CSS is automatically included in Flowbite) -->
    <link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />

    <!-- Tailwind CSS (optional if you need additional customization) -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->

    <!-- jQuery Library -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>

    <!-- Simple DataTables CDN -->
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@9.0.3"></script>
</head>

<body class="bg-gray-100">

    <!-- Container for the Table -->
    <div class="container mx-auto p-6">
        <table id="pagination-table" class="table-auto w-full text-sm text-left text-gray-500 border-collapse">
            <thead class="bg-blue-100">
                <tr>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Nama
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Mantan
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Email
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Phone
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Amount
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Transaction Date
                    </th>
                    <th class="px-6 py-3 font-medium text-gray-900">
                        Status
                    </th>
                </tr>
            </thead>
            <tbody class="bg-white">
                <!-- Data rows will be inserted here dynamically -->
            </tbody>
        </table>
    </div>

    <!-- Flowbite JS -->
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>

    <script>
        // Fetch data from your server-side API or database
        async function fetchData() {
            try {
                const response = await fetch('get_transactions.php'); // Replace with your actual API endpoint
                const data = await response.json(); // Assuming the response is in JSON format
    
                const tableBody = document.querySelector("#pagination-table tbody");
    
                // Clear any existing rows in the table body
                tableBody.innerHTML = '';
    
                // Loop through the data and create table rows dynamically
                data.forEach(item => {
                    
                    // Format the total_amount as IDR (Indonesian Rupiah)
                    const formattedAmount = new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR' }).format(item.total_amount);
    
                    const row = document.createElement("tr");
                    row.classList.add('border-b'); // Adding a bottom border for each row
    
                    row.innerHTML = `
                        <td class="px-6 py-4">${item.name_1} ${item.name_2 ? ' / ' + item.name_2 : ''}</td>
                        <td class="px-6 py-4">${item.mantan_1} ${item.mantan_2 ? ' / ' + item.mantan_2 : ''}</td>
                        <td class="px-6 py-4">${item.email_1} ${item.email_2 ? ' / ' + item.email_2 : ''}</td>
                        <td class="px-6 py-4">${item.phone_1} ${item.phone_2 ? ' / ' + item.phone_2 : ''}</td>
                        <td class="px-6 py-4">${formattedAmount}</td>
                        <td class="px-6 py-4">${item.transaction_date}</td>
                        <td class="px-6 py-4">
                            <p class="text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full">
                            ${item.status}
                            </p>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
    
                // Initialize the DataTable after the data is populated
                if (document.getElementById("pagination-table") && typeof simpleDatatables.DataTable !== 'undefined') {
                    new simpleDatatables.DataTable("#pagination-table", {
                        searchable: true,
                        paging: true,
                        perPage: 5,
                        perPageSelect: [5, 10, 15, 20, 25],
                        sortable: false
                    });
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }
    
        // Call fetchData to populate the table
        fetchData();
    </script>

</body>

</html>
