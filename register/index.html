<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FunRun Lari Sama Mantan</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100">
  <div class="max-w-md mx-auto overflow-hidden">
    <div class="relative">
      <img alt="FunRun Lari Sama Mantan" class="w-full h-screen-1/2 object-cover" src="./assets/image/bg.jpg">
    </div>
    <!-- <div class="scrolling-sponsors">
      <div class="sponsor-images">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/ArtotelCasaKuningan.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/ArtotelGajahMada.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/DafamWonosobo.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/GrandDafamAncol.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/GrandDafamBraga.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/KyriadMakassar.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/MaxoneBoyolali.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/MeotelPurwokerto.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/RoyalSingosariCendana.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/SurabayaSuiteHotel.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/SwissBelinBogor.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/SwissBelinMalang.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/TSArtotelSurabaya.png">
        <img alt="Thumbnail sponsor" class="h-12 object-fill dark-img" src="./assets/image/sponsor/Nexa.png">
        <img alt="Thumbnail sponsor" class="h-8 object-fill" src="./assets/image/sponsor/babyface.png">
      </div>
    </div> -->
    
    <div class="p-4">
      <h2 class="text-2xl font-semibold helvetica">Funrun - Lari Sama Mantan</h2>
      <h3 class="text-lg text-gray-700 font-semibold helvetica">Hotel Dafam Semarang</h3>

      <div class="flex items-center mt-2">
        <i class="fas fa-calendar-alt text-[#ff005b]"></i>
        <p class="ml-2 helvetica text-gray-700">05 05 2025</p>
      </div>

      <div class="flex items-center mt-2">
        <i class="fas fa-clock text-[#ff005b]"></i>
        <p class="ml-2 helvetica text-gray-700">05:00 WIB</p>
      </div>

      <div class="mt-4 w-3/4">
        <h3 class="text-lg font-semibold helvetica">Contact</h3>
        <div class="flex justify-between items-center mt-2">
          <a href="https://wa.me/6285702127087?text=Halo,%20saya%20ada%20pertanyaan">
            <div class="flex items-center">
              <i class="fab fa-whatsapp text-gray-700"></i>
              <p class="ml-2 helvetica text-gray-700">Official Fun Run</p>
            </div>
          </a>
        </div>
      </div>

      <div class="mt-4">
        <h3 class="text-lg font-semibold helvetica">About</h3>
        <p class="helvetica text-gray-700 mt-2">
          Meningkatnya minat masyarakat terhadap aktivitas olahraga dan gaya hidup sehat, serta kebutuhan untuk mencip-
          takan momen kebersamaan yang unik, menginspirasi kami untuk mengadakan acara Fun Run ke-5 kalinya dengan
          tema yang menarik dan penuh kejutan, yaitu
          "Lari Sama Mantan"
          . Acara ini bukan hanya sekadar olahraga, namun
          juga kesempatan untuk menjalin hubungan sosial, bersenang-senang, dan mengenang kembali kenangan bersama
          orang-orang terdekat, termasuk mantan. Kami berharap kegiatan ini dapat menjadi media hiburan, edukasi, dan
          promosi bagi Hotel Dafam Semarang sebagai tempat akomodasi yang menyenangkan di Kota Semarang
        </p>
      </div>

      <div class="mt-4 mb-32">
        <!-- <h3 class="text-lg font-semibold helvetica">Location</h3> -->
        <div class="flex items-center mt-2">
          <i class="fas fa-map-marker-alt text-[#ff005b]"></i>
          <p class="ml-2 helvetica text-gray-700">Jl. Imam Bonjol No.188, Semarang</p>
        </div>
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3960.2508286818183!2d110.40941237686833!3d-6.979701993021142!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e708b4d0808faa9%3A0x1c54882d293f1937!2sHotel%20Dafam%20Semarang!5e0!3m2!1sen!2sid!4v1737694104499!5m2!1sen!2sid" 
          class="w-full h-32 max-w-md rounded-[24px] shadow-md" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>

      <!-- Form Box -->
      <div id="box" class="bg-white rounded-t-[24px] shadow-md w-full p-4 flex max-w-md mt-4 fixed bottom-0 left-0 right-0 mx-auto z-50">
        <div class="w-full p-4 flex items-center justify-between h-32 max-w-md mt-4 fixed bottom-0 left-0 right-0 mx-auto z-50">
          <div id="items-container"></div>
          <button id="registerBtn" class="button w-40 bottom is-primary text-white font-semibold py-4 px-8 rounded-full">Join Now</button>
        </div>
        <div id="signup-container" class="hidden">
        <button id="closeBtn" class="icon-button shadow-md rounded-full absolute top-2 right-2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                <path fill="none" d="M0 0h24v24H0z" />
                <path fill="currentColor" d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z" />
            </svg>
        </button>

        <form id="registrationForm">
          <!-- Radio buttons for Single and Couple -->
          <div class="mt-2 flex space-x-4">
            <label>
              <input type="radio" name="registrationType" value="single" id="single" class="mr-2" checked> Single
            </label>
            <label>
              <input type="radio" name="registrationType" value="couple" id="couple" class="mr-2"> Couple
            </label>
          </div>

          <!-- Name field -->
           <div class="mt-4 flex">
            <div class="w-full">
              <label for="name" class="block text-gray-700">Your Name</label>
              <input type="text" id="name" class="mt-2 p-2 w-full border border-gray-300 rounded-full" placeholder="Name" required>
            </div>
          </div>
          <!-- Size -->
          <div class="mt-2 flex space-x-4">
            <div class="w-full">
              <label for="size" class="block text-gray-700">Size Jarsey</label>
              <label>
                <input type="radio" name="size" value="s" id="s" class="mr-2" required>S
              </label>
              <label>
                <input type="radio" name="size" value="m" id="m" class="mr-2" required>M
              </label>
              <label>
                <input type="radio" name="size" value="l" id="l" class="mr-2" required>L
              </label>
              <label>
                <input type="radio" name="size" value="xl" id="xl" class="mr-2" required>XL
              </label>
              <label>
                <input type="radio" name="size" value="xxl" id="xxl" class="mr-2" required>XXL
              </label>
            </div>
          </div>

          <!-- Couple Section (hidden initially) -->
          <div id="CoupleContainer" class="mt-4 hidden">
            <div class="flex space-x-4">
              <div class="w-full">
                <label for="coupleName" class="block text-gray-700">Couple Name</label>
                <input type="text" id="coupleName" class="mt-2 p-2 w-full border border-gray-300 rounded-full" placeholder="Name" required>
              </div>
            </div>  

            <div class="mt-2 flex space-x-4">
              <div class="w-full">
                <label for="coupleSize" class="block text-gray-700">Size Jarsey</label>
                <label>
                  <input type="radio" name="coupleSize" value="s" id="scouple" class="mr-2" required>S
                </label>
                <label>
                  <input type="radio" name="coupleSize" value="m" id="mcouple" class="mr-2" required>M
                </label>
              </div>
            </div>
          </div>

          <!-- Phone Email -->
          <div class="mt-4">
              <label for="phone" class="block text-gray-700">Phone</label>
              <input type="text" id="phone" class="mt-2 p-2 w-full border border-gray-300 rounded-full" placeholder="62xxxxxxxxxx" required>
          </div>

          <div class="mt-2">
              <label for="email" class="block text-gray-700">Email</label>
              <input type="email" id="email" class="mt-2 p-2 w-full border border-gray-300 rounded-full" placeholder="yourmail@xxx" required>
          </div>

          <input type="hidden" id="transactionid" name="transactionid" value="">

          <div class="w-full p-4 flex items-center justify-between h-32 max-w-md mt-4 fixed bottom-0 left-0 right-0 mx-auto z-50">
            <div></div>
            <button id="signUpBtn" type="submit" class="button w-40 is-primary text-white font-semibold py-4 px-8 rounded-full">Payment</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
      <div class="bg-white p-4 rounded-[24px] shadow-md max-w-sm w-full mx-4 zoom-in">
          <h2 class="text-2xl font-bold text-center text-gray-700">Payment</h2>
          <p class="mt-4 text-gray-500 text-sm text-left">Silakan lakukan pembayaran ke No. Rekening berikut.</p>
                   
          <div id="transaction-details-container" class="mt-2 mb-2 text-center text-xs text-gray-500"></div>
          <div class="mt-2 flex items-center">
            <img alt="mandiri" class="mb-2 h-4 object-fill" src="./assets/image/mandiri.png">
            <p class="text-gray-700 text-xs" id="rek-number">2526666663</p>
            <button class="ml-2 text-gray-500 text-xs" onclick="copyToClipboard()">
              <i class="fas fa-clone"></i>
            </button>
          </div>     
        <p class="text-gray-700 text-xs">PT Dafam Mambo International</p>
        <div class="mt-4 flex flex-col items-center border-dashed border-2 border-gray-400 p-4 rounded-lg">
          <div id="file-info" class="mt-4 text-center text-sm text-gray-500">
            <p id="file-name" class="font-medium"></p>
            <p id="file-size" class="text-xs"></p>
          </div>
          <p class="mb-4 text-gray-500 text-xs text-center">
            Upload bukti pembayaran disini
            <label for="paymentproof" class="cursor-pointer">
              <span class="text-[#ff005b]">Choose File</span>
            </label>
            <input type="file" id="paymentproof" class="hidden" accept="application/pdf, image/*">
          </p>
        
          <button id="uploadButton" class="mt-4 bg-white text-gray-700 font-semibold py-3 px-6 rounded-full shadow-md">
            <i class="fas fa-upload mr-2"></i><span>Upload</span>
          </button>
        </div>
      </div>
    </div>    

  </div>
</div>
  
    <script>
      function copyToClipboard() {
        const rekNumber = document.getElementById('rek-number').innerText;
        
        navigator.clipboard.writeText(rekNumber)
          .then(() => {
            alert('Nomor rekening berhasil disalin!');
          })
          .catch(err => {
            console.error('Gagal menyalin: ', err);
          });
      }


      const singleRadio = document.getElementById('single');
      const coupleRadio = document.getElementById('couple');
      const coupleContainer = document.getElementById('CoupleContainer');
      const coupleName = document.getElementById('coupleName');

      const scouple = document.getElementById('scouple');
      const Size = document.getElementById('Size');

      const registerBtn = document.getElementById("registerBtn");
      const closeBtn = document.getElementById("closeBtn");
      const box = document.getElementById("box");
      const signupContainer = document.getElementById("signup-container");

      // Hide the Couple Section initially and remove required attributes
      if (coupleContainer.classList.contains('hidden')) {
        coupleName.removeAttribute('required');
        scouple.removeAttribute('required');
      }

      // Show Couple Section and add required attributes when "Couple" radio is checked
      coupleRadio.addEventListener('change', function () {
        if (this.checked) {
          coupleContainer.classList.remove('hidden');
          coupleName.setAttribute('required', 'true');
          scouple.setAttribute('required', 'true');
        }
      });

      // Hide Couple Section and remove required attributes when "Single" radio is checked
      singleRadio.addEventListener('change', function () {
        if (this.checked) {
          coupleContainer.classList.add('hidden');
          coupleName.removeAttribute('required');
          scouple.removeAttribute('required');
        }
      });

      registerBtn.addEventListener("click", function() {
          box.classList.add("expanded");
          registerBtn.classList.add("hidden");
          setTimeout(function() {
            signupContainer.classList.remove("hidden");
          }, 200);
      });

      closeBtn.addEventListener("click", function() {
          box.classList.remove("expanded");
          registerBtn.classList.remove("hidden");
          setTimeout(function() {
            signupContainer.classList.add("hidden");
          }, 200);
      });

      function formatPrice(price) {
          if (price >= 1000000) {
              return (price / 1000000).toFixed(1) + 'M';
          } else if (price >= 1000) {
              return (price / 1000).toFixed(0) + 'K';
          } else {
              return price;
          }
      }

      fetch('get_items.php')
        .then(response => response.json())
        .then(data => {
          const container = document.getElementById('items-container'); // Misalnya ada container untuk menampung data
          data.forEach(item => {
            const itemElement = document.createElement('div');
            
            const descriptionElement = document.createElement('p');
            descriptionElement.className = 'helvetica text-gray-400 text-sm';
            descriptionElement.textContent = `${item.description}`;
            
            const priceElement = document.createElement('p');
            priceElement.className = 'helvetica text-[#ff005b] font-bold';
            priceElement.textContent = `IDR ${formatPrice(item.price)} / Person`;
            
            itemElement.appendChild(descriptionElement);
            itemElement.appendChild(priceElement);
            
            container.appendChild(itemElement);
          });
        })
        .catch(error => console.error('Error:', error));

        function formatFileName(fileName) {
            const nameWithoutExt = fileName.substring(0, fileName.lastIndexOf('.')) || fileName; // Menghapus ekstensi
            if (nameWithoutExt.length > 10) {
                return nameWithoutExt.substring(0, 10) + '...';
            }
            return nameWithoutExt; 
        }

        function formatFileSize(size) {
            if (size >= 1000000) {
                return (size / 1000000).toFixed(2) + ' MB';
            } else if (size >= 1000) {
                return (size / 1000).toFixed(0) + ' KB';
            } else {
                return size + ' bytes';
            }
        }

        const paymentInput = document.getElementById('paymentproof');
        const paymentName = document.getElementById('file-name');
        const paymentSize = document.getElementById('file-size');

        paymentInput.addEventListener('change', function () {
            const file = paymentInput.files[0];
            if (file) {
                const fileName = formatFileName(file.name);
                const fileSize = formatFileSize(file.size);
                
                paymentName.textContent = fileName;
                paymentSize.textContent = `${fileSize}`;
            } else {
                paymentName.textContent = ''; // Clear if no file selected
                paymentSize.textContent = ''; // Clear if no file selected
            }
        });

        const photoInput = document.getElementById('photo');
        const photoName = document.getElementById('photo-name');
        const photoSize = document.getElementById('photo-size');

        photoInput.addEventListener('change', function () {
            const file = photoInput.files[0];
            if (file) {
                const fileName = formatFileName(file.name);
                const fileSize = formatFileSize(file.size);
                
                photoName.textContent = fileName;
                photoSize.textContent = `${fileSize}`;
            } else {
                photoName.textContent = ''; // Clear if no file selected
                photoSize.textContent = ''; // Clear if no file selected
            }
        });

        const couplePhotoInput = document.getElementById('couplePhoto');
        const couplePhotoName = document.getElementById('couple-photo-name');
        const couplePhotoSize = document.getElementById('couple-photo-size');

        couplePhotoInput.addEventListener('change', function () {
            const file = couplePhotoInput.files[0];
            if (file) {
                const fileName = formatFileName(file.name);
                const fileSize = formatFileSize(file.size);
                
                couplePhotoName.textContent = fileName;
                couplePhotoSize.textContent = `${fileSize}`;
            } else {
                couplePhotoName.textContent = ''; // Clear if no file selected
                couplePhotoSize.textContent = ''; // Clear if no file selected
            }
        });

        function generateTransactionId() {
            return 'TPE-' + Date.now() + '-' + Math.floor(Math.random() * 1000);
        }

        const transactionIdInput = document.getElementById('transactionid');
        const generatedTransactionId = generateTransactionId();
        transactionIdInput.value = generatedTransactionId;



        //===========================================================

        registrationForm.addEventListener('submit', function(event) {
        event.preventDefault(); 

        const formData = new FormData();

        const registrationType = document.querySelector('input[name="registrationType"]:checked').value;
        const username = document.getElementById('name').value;
        const age = document.getElementById('age').value;
        const gender = document.querySelector('input[name="gender"]:checked').value;
        const phone = document.getElementById('phone').value;
        const email = document.getElementById('email').value;

        formData.append('transactionid', generatedTransactionId);
        formData.append('registrationType', registrationType);
        formData.append('username', username);
        formData.append('age', age);
        formData.append('gender', gender);
        formData.append('phone', phone);
        formData.append('email', email);

        const photoInput = document.getElementById('photo');
        if (photoInput.files.length > 0) {
            formData.append('photo', photoInput.files[0]); 
        }

        if (registrationType === 'couple') {
            const coupleUsername = document.getElementById('coupleName').value;
            const coupleAge = document.getElementById('coupleage').value;
            const coupleGender = document.querySelector('input[name="coupleGender"]:checked').value;
            formData.append('coupleUsername', coupleUsername);
            formData.append('coupleAge', coupleAge);
            formData.append('coupleGender', coupleGender);

            const couplePhotoInput = document.getElementById('couplePhoto');
            if (couplePhotoInput.files.length > 0) {
                formData.append('couplePhoto', couplePhotoInput.files[0]); 
            }
        }

        fetch('register.php', {
            method: 'POST',
            body: formData 
        })
        .then(response => response.json())
        .then(data => {
            console.log(data); 
            if (data.status === 'success') {
                // Only set to localStorage if the gender is not 'female'
                if (gender !== 'female') {
                    localStorage.setItem('registrationSuccess', 'true');
                    localStorage.setItem('transactionid', generatedTransactionId);
                }

                box.classList.remove("expanded");
                registerBtn.classList.remove("hidden");
                setTimeout(function() {
                    signupContainer.classList.add("hidden");
                }, 200);
                
                const transactionIdFromLocalStorage = localStorage.getItem('transactionid');

                // Show success modal only if the gender is male
                if (gender === 'male') {
                    const successModal = document.getElementById('successModal');
                    successModal.classList.remove('hidden');

                    const transactionIdDisplay = document.getElementById('transaction-id');
                    fetch(`get_transaction.php?transaction_id=${transactionIdFromLocalStorage}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok ' + response.statusText);
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Transaction Details:', data);

                        const transactionDetailsContainer = document.getElementById('transaction-details-container');
                        if (data.error) {
                            transactionDetailsContainer.innerHTML = `<p class="text-center text-red-500">${data.error}</p>`;
                        } else {
                            const totalAmount = parseFloat(data[0].total_amount); 
                            const transactionDate = data[0].transaction_date;

                            const formattedDate = new Date(transactionDate.replace(' ', 'T')).toLocaleString();  

                            const formattedAmount = 'Rp' + new Intl.NumberFormat('id-ID', {
                              maximumFractionDigits: 0 
                            }).format(totalAmount);

                            transactionDetailsContainer.innerHTML = `
                              <ul>
                                  <li class="flex justify-between">
                                      <span><strong>Transaction ID</strong></span>
                                      <span class="text-rigth">${transactionIdFromLocalStorage}</span>
                                  </li>
                                  <li class="flex justify-between">
                                      <span><strong>Total Amount</strong></span>
                                      <span class="text-rigth"><strong>${formattedAmount}</strong></span>
                                  </li>
                                  <li class="flex justify-between">
                                      <span><strong>Transaction Date</strong></span>
                                      <span class="text-right">${formattedDate}</span>
                                  </li>
                              </ul>
                            `;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching transaction details:', error);
                        const transactionDetailsContainer = document.getElementById('transaction-details-container');
                        transactionDetailsContainer.innerHTML = `<p class="text-center text-red-500">Terjadi kesalahan saat mengambil detail transaksi.</p>`;
                    });
                }

                // Show SweetAlert for female gender
                if (gender === 'female') {
                    Swal.fire({
                        icon: 'success',
                        title: 'Thank you for being a part of the third-party effect.',
                        text: 'Your payment proof has been received. Please wait for confirmation.',
                        timer: 60000,
                        timerProgressBar: true,
                        showConfirmButton: false,
                        customClass: {
                            popup: 'rounded-[24px] text-left text-gray-700 p-6 shadow-lg',
                            title: 'text-lg font-semibold',
                            content: 'text-sm text-gray-500',
                        },
                        willClose: () => {
                            localStorage.removeItem('transactionid');
                            localStorage.removeItem('registrationSuccess');
                        }
                    });
                }

                registrationForm.reset();
            } else {
                alert('Terjadi kesalahan, coba lagi.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Terjadi kesalahan saat mengirim data.');
        });
    });
        //===========================================================

        window.addEventListener('load', function() {
            if (localStorage.getItem('registrationSuccess') === 'true') {
                const successModal = document.getElementById('successModal');
                successModal.classList.remove('hidden');
                const transactionIdFromLocalStorage = localStorage.getItem('transactionid');

            fetch(`get_transaction.php?transaction_id=${transactionIdFromLocalStorage}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Transaction Details:', data);

                    const transactionDetailsContainer = document.getElementById('transaction-details-container');
                    if (data.error) {
                        transactionDetailsContainer.innerHTML = `<p class="text-center text-red-500">${data.error}</p>`;
                    } else {
                        const totalAmount = parseFloat(data[0].total_amount);
                        const transactionDate = data[0].transaction_date;

                        const formattedDate = new Date(transactionDate.replace(' ', 'T')).toLocaleString(); 

                        const formattedAmount = 'Rp' + new Intl.NumberFormat('id-ID', {
                          maximumFractionDigits: 0 
                        }).format(totalAmount);

                        transactionDetailsContainer.innerHTML = `
                          <ul>
                              <li class="flex justify-between">
                                  <span><strong>Transaction ID</strong></span>
                                  <span class="text-rigth">${transactionIdFromLocalStorage}</span>
                              </li>
                              <li class="flex justify-between">
                                  <span><strong>Total Amount</strong></span>
                                  <span class="text-rigth"><strong>${formattedAmount}</strong></span>
                              </li>
                              <li class="flex justify-between">
                                  <span><strong>Transaction Date</strong></span>
                                  <span class="text-right">${formattedDate}</span>
                              </li>
                          </ul>
                        `;
                    }
                })
                .catch(error => {
                    console.error('Error fetching transaction details:', error);
                    const transactionDetailsContainer = document.getElementById('transaction-details-container');
                    transactionDetailsContainer.innerHTML = `<p class="text-center text-red-500">Terjadi kesalahan saat mengambil detail transaksi.</p>`;
                });
              }
            });

            document.getElementById("uploadButton").addEventListener("click", function() {
            const fileInput = document.getElementById("paymentproof");
            const file = fileInput.files[0];

            const transactionId = localStorage.getItem('transactionid');
            if (!transactionId) {
                alert("Transaction ID tidak ditemukan di localStorage.");
                return;
            }

            if (!file) {
                alert("Silakan pilih file untuk diupload.");
                return;
            }

            const formData = new FormData();
            formData.append("paymentproof", file);

            fetch(`prooft_payment.php?transaction_id=${transactionId}`, {
                method: "POST",
                body: formData,
            })
            .then(response => {
                console.log('Response:', response);
                return response.text();
            })
            .then(data => {
                try {
                    const jsonData = JSON.parse(data);
                    if (jsonData.success) {
                        const successModal = document.getElementById('successModal');
                        successModal.classList.add('hidden');

                        Swal.fire({
                            icon: 'success',
                            title: 'Thank you for being a part of the third-party effect.',
                            text: 'Your payment proof has been received. Please wait for confirmation.',
                            timer: 60000,
                            timerProgressBar: true,
                            showConfirmButton: false,
                            customClass: {
                                popup: 'rounded-[24px] text-left text-gray-700 p-6 shadow-lg',
                                title: 'text-lg font-semibold',
                                content: 'text-sm text-gray-500',
                            },
                            willClose: () => {
                                localStorage.removeItem('transactionid');
                                localStorage.removeItem('registrationSuccess');
                            }
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error',
                            text: jsonData.error || "Terjadi kesalahan saat mengupload file.",
                            customClass: {
                                popup: 'rounded-[24px] text-left text-gray-700 p-6 shadow-lg',
                                title: 'text-lg font-semibold',
                                content: 'text-sm text-gray-500',
                            }
                        });
                    }
                } catch (error) {
                    console.error("Error parsing JSON:", error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: "Terjadi kesalahan saat mengupload file.",
                        customClass: {
                                popup: 'rounded-[24px] text-left text-gray-700 p-6 shadow-lg',
                                title: 'text-lg font-semibold',
                                content: 'text-sm text-gray-500',
                            }
                        });
                    }
                });
            });
    </script>

</body>
</html>
